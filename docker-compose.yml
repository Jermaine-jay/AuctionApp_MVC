version: '3.4'

services:

    app_database:
        image: postgres:latest
        container_name: app_db
        environment:
          - POSTGRES_USER=applicationdb_fpio_user
          - POSTGRES_PASSWORD=wZcq1oC8lKYEnWkr36FpF1aqVFHqWXi7
          - POSTGRES_DB=applicationdb_fpio
        ports:
          - 5432:5433

        restart: always
 
    aunctionappmvc:
        image: ${DOCKER_REGISTRY-}aunctionappmvc
        build:
          context: .
          dockerfile: AunctionAppMVC/Dockerfile

        depends_on:
            - "app_database"
        environment: 
             - ConnectionStrings:DefaultConnection="Host=dpg-cnt268fjbltc7398dcg0-a;Database=applicationdb_fpio;Username=applicationdb_fpio_user;Password=wZcq1oC8lKYEnWkr36FpF1aqVFHqWXi7;Port=5432;"
             - ASPNETCORE_URLS=http://+80